{"version":3,"file":"commonHelpers.js","sources":["../src/js/constants.js","../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export const CONSTANTS = {\n  API_KEY: '42384910-73277182c896d015737fb8e33',\n  API_URL: 'https://pixabay.com/api/',\n  PHOTO_ORIENTATION: 'horizontal',\n  IMAGE_TYPE: 'photo',\n  SAFESEARCH: true,\n  PHOTOS_PER_PAGE: 15,\n  ERROR_MESSAGES: {\n    EMPTY_INPUT: 'Input must not be empty. Please try again!',\n    IMAGES_NOT_FOUND:\n      'Sorry, there are no images matching your search query. Please try again!',\n    RESOURSE_ERROR: 'Requested resource is not found!',\n  },\n  NOTIFICATION_MESSAGE: {\n    PHOTO_LIMIT_REACHED:\n      \"We're sorry, but you've reached the end of search results.\",\n  },\n  POP_UP_CONFIG: {\n    message: null,\n    iconUrl: '/img/error-icon.png',\n    messageColor: 'white',\n    backgroundColor: '#EF4040',\n    position: 'topRight',\n  },\n  POP_UP_CONFIG_NOTIFICATION: {\n    message: null,\n    iconUrl: '/img/exclamation-mark.png',\n    messageColor: 'white',\n    backgroundColor: '#87CEEB',\n    position: 'topRight',\n  },\n};\n","import axios from 'axios';\nimport { CONSTANTS } from './constants.js';\n\nexport async function urlCreator(searchedPhoto, pageParam) {\n  const getUrl = await axios.get(CONSTANTS.API_URL, {\n    params: {\n      key: CONSTANTS.API_KEY,\n      q: searchedPhoto,\n      image_type: CONSTANTS.IMAGE_TYPE,\n      orientation: CONSTANTS.PHOTO_ORIENTATION,\n      safesearch: CONSTANTS.SAFESEARCH,\n      page: pageParam,\n      per_page: CONSTANTS.PHOTOS_PER_PAGE,\n    },\n  });\n  return getUrl;\n}\n","export function htmlMarkupCreator(galleryItems) {\n  return galleryItems\n    .map(item => {\n      const {\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      } = item;\n      return `<li class=\"list-item\">\n      <div class=\"gallery-photo\">\n        <a href=\"${largeImageURL}\"\n          ><img src=\"${webformatURL}\" alt=\"${tags}\"\n        /></a>\n      </div>\n      <div class=\"text-wrapper\">\n        <div class=\"list-item-container\">\n          <p class=\"header-text\">likes</p>\n          <p>${likes}</p>\n        </div>\n        <div class=\"list-item-container\">\n          <p class=\"header-text\">Views</p>\n          <p>${views}</p>\n        </div>\n        <div class=\"list-item-container\">\n          <p class=\"header-text\">Comments</p>\n          <p>${comments}</p>\n        </div>\n        <div class=\"list-item-container\">\n          <p class=\"header-text\">Downloads</p>\n          <p>${downloads}</p>\n        </div>\n      </div>\n    </li>`;\n    })\n    .join('');\n}\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport { CONSTANTS } from './js/constants';\nimport { urlCreator } from './js/pixabay-api.js';\nimport { htmlMarkupCreator } from './js/render-functions.js';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelectorAll('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\nconst listItem = document.querySelectorAll('.list-item');\nconst loaders = {\n  firstLoader: loader[0],\n  secondLoader: loader[1],\n};\n\nlet pageParam = 2;\nlet inputValue = null;\nlet galleryLightBox = null;\n\nform.addEventListener('submit', e => {\n  e.preventDefault();\n  galleryLightBox = new SimpleLightbox('.gallery-photo a');\n  gallery.innerHTML = '';\n\n  inputChecker(sessionStorage.getItem('previousInput'), input.value);\n\n  if (!input.value) {\n    showPopUpMessage(CONSTANTS.ERROR_MESSAGES.EMPTY_INPUT, 'error');\n  } else {\n    loaders.firstLoader.classList.remove('hidden');\n    inputValue = input.value;\n    urlCreator(input.value)\n      .then(({ data: { hits } }) => {\n        if (!hits.length) {\n          showPopUpMessage(CONSTANTS.ERROR_MESSAGES.IMAGES_NOT_FOUND, 'error');\n        } else {\n          gallery.insertAdjacentHTML('beforeend', htmlMarkupCreator(hits));\n          loadMoreBtn.classList.remove('hidden');\n          galleryLightBox.refresh();\n        }\n        loaders.firstLoader.classList.add('hidden');\n      })\n      .catch(error => {\n        console.debug(error);\n        showPopUpMessage(CONSTANTS.ERROR_MESSAGES.RESOURSE_ERROR, 'error');\n      });\n  }\n\n  sessionStorage.setItem('previousInput', input.value);\n});\n\nloadMoreBtn.addEventListener('click', e => {\n  loaders.secondLoader.classList.remove('hidden');\n\n  urlCreator(inputValue, pageParam)\n    .then(({ data: { hits, totalHits } }) => {\n      loaders.secondLoader.classList.add('hidden');\n\n      gallery.insertAdjacentHTML('beforeend', htmlMarkupCreator(hits));\n      galleryLightBox.refresh();\n      gentleScrollCreator();\n      photoLimitCalculator(totalHits, pageParam);\n      pageParam++;\n    })\n    .catch(error => {\n      console.debug(error);\n      showPopUpMessage(CONSTANTS.ERROR_MESSAGES.RESOURSE_ERROR, 'error');\n    });\n});\nfunction showPopUpMessage(message, status) {\n  switch (status) {\n    case 'error':\n      iziToast.show({\n        ...CONSTANTS.POP_UP_CONFIG,\n        message,\n      });\n      break;\n    case 'notification':\n      iziToast.show({\n        ...CONSTANTS.POP_UP_CONFIG_NOTIFICATION,\n        message,\n      });\n  }\n}\n\nfunction photoLimitCalculator(totalAllowedPhotos, page) {\n  if (totalAllowedPhotos <= page * CONSTANTS.PHOTOS_PER_PAGE) {\n    loadMoreBtn.classList.add('hidden');\n    showPopUpMessage(\n      CONSTANTS.NOTIFICATION_MESSAGE.PHOTO_LIMIT_REACHED,\n      'notification'\n    );\n  }\n} //function calculates if the elements on the page exceeded allowed element limit.\n\nfunction gentleScrollCreator() {\n  const firstGalleryChild = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: firstGalleryChild.height * 4, // height * 4 works better\n    behavior: 'smooth',\n  });\n}\n\n//function checks if new input differs from previous and reset the page counter\nfunction inputChecker(storedItem, currentInput) {\n  if (storedItem !== currentInput) {\n    return (pageParam = 2);\n  }\n}\n"],"names":["CONSTANTS","urlCreator","searchedPhoto","pageParam","axios","htmlMarkupCreator","galleryItems","item","largeImageURL","webformatURL","tags","likes","views","comments","downloads","form","input","gallery","loader","loadMoreBtn","loaders","inputValue","galleryLightBox","e","SimpleLightbox","inputChecker","hits","showPopUpMessage","error","totalHits","gentleScrollCreator","photoLimitCalculator","message","status","iziToast","totalAllowedPhotos","page","firstGalleryChild","storedItem","currentInput"],"mappings":"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"}